<html>
    <head>
        <title>Hora Agora - Cronometro</title>
        <meta http-equiv="Description" content="O relogio quebrou? Esta atrasado ou adiantado? Saiba a hora certa agora entrando em www.horaagora.com"/>
        <meta http-equiv="Keywords" content="hora, horario, tempo, minuto, agora, relogio, atrasado, adiantado"/>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript">
        </script>
        <link rel="stylesheet" type="text/css" href="style/main.css" />
        <script src="style/jquery-impromptu.3.1.min.js" type="text/javascript">
        </script>
        <link rel="stylesheet" type="text/css" href="style/impromptu.css" />
        <script type="text/javascript">
            
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-4126737-4']);
            _gaq.push(['_setDomainName', '.horaagora.com']);
            _gaq.push(['_trackPageview']);
            
            (function(){
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            
            var secs;
            var timerID = null;
            var timerRunning = false;
            var delay = 1000;
			
			var audioElement = document.createElement('audio');
			audioElement.setAttribute('src', 'style/timer.ogg');

            function initializeTimer(tempo){
                stopTheClock();
                if (validateTime(tempo)) {
                    startTheTimer();
                }
            }
            
            function validateTime(tempo){
                t = tempo.split(':');
                if (t.length > 1) {
                    secs = parseInt(t[0]) * 60 + parseInt(t[1]);
                }
                else {
                    secs = parseInt(tempo);
                }
                if (isNaN(secs) || tempo.indexOf(':') != tempo.lastIndexOf(':')) {
                    $.prompt('Digite o tempo no formato<br/>MM:SS<br/><br/><input type="text" id="alertName" name="alertName" value="02:00" />', {
                        callback: callbackOk,
                        buttons: {
                            Iniciar: 'Ok'
                        }
                    });
                    
                    return false;
                }
                return true;
            }
            
            function stopTheClock(){
                if (timerRunning) 
                    clearTimeout(timerID);
                timerRunning = false;
            }
            
            function startTheTimer(){
                printTime(secs);
                if (secs == 0) {
                    stopTheClock()
                    $.prompt('Tempo Esgotado!');
					audioElement.play();
                    _gaq.push(['_trackEvent', 'Cronometro', 'Stop', 'Tempo', secs]);
                }
                else {
                    secs = secs - 1;
                    timerRunning = true;
                    timerID = self.setTimeout("startTheTimer()", delay);
                }
            }
            
            function printTime(secs){
                minute = Math.floor(secs / 60);
                if (minute < 10) 
                    minute = '0' + minute;
                $("#minute").text(minute);
                second = secs % 60;
                if (second < 10) 
                    second = '0' + second;
                $("#second").text(second);
            }
            
            function callbackOk(v, m, f){
                if (v != undefined) {
                    initializeTimer(f.alertName);
                    _gaq.push(['_trackEvent', 'Cronometro', 'Start', 'Tempo', secs]);
                }
            }
            
            $(document).ready(function(){
                $.prompt('<br />Digite o tempo para contagem regressiva:<br /><br /><input type="text" id="alertName" name="alertName" value="02:00" />', {
                    callback: callbackOk,
                    buttons: {
                        Iniciar: 'Ok'
                    }
                });
            });
        </script>
        <!-- Share This -->
        <script type="text/javascript" src="http://w.sharethis.com/button/sharethis.js#publisher=0c420224-15ff-4d23-987a-858382d4aff7&amp;type=website&amp;post_services=email%2Cfacebook%2Ctwitter%2Cgbuzz%2Cdigg%2Cdelicious%2Cgoogle_bmarks%2Clinkedin&amp;button=false">
        </script>
    </head>
    <body>
        <div id="flattr" class="share">
            <a href="http://flattr.com/thing/2077/Baniverso" target="_blank" onClick="_gaq.push(['_trackEvent', 'Money', 'Flattr']);"><img src="http://api.flattr.com/button/button-compact-static-100x17.png" alt="Flattr this" title="Flattr this" border="0" /></a>
        </div>
        <div id="sharethis" class="share">
            <a id="ck_email" class="stbar chicklet" href="javascript:void(0);"><img src="http://w.sharethis.com/chicklets/email.gif" /></a><a id="ck_facebook" class="stbar chicklet" href="javascript:void(0);"><img src="http://w.sharethis.com/chicklets/facebook.gif" /></a><a id="ck_twitter" class="stbar chicklet" href="javascript:void(0);"><img src="http://w.sharethis.com/chicklets/twitter.gif" /></a><a id="ck_sharethis" class="stbar chicklet" href="javascript:void(0);"><img src="http://w.sharethis.com/chicklets/sharethis.gif" /></a>
            <script type="text/javascript">
                var shared_object = SHARETHIS.addEntry({
                    title: document.title,
                    url: document.location.href
                });
                
                shared_object.attachButton(document.getElementById("ck_sharethis"));
                shared_object.attachChicklet("email", document.getElementById("ck_email"));
                shared_object.attachChicklet("facebook", document.getElementById("ck_facebook"));
                shared_object.attachChicklet("twitter", document.getElementById("ck_twitter"));
            </script>
        </div>
        <div class="time">
            <span id="minute">--</span>:<span id="second">--</span>
        </div>

        <div id="about">
            <h1>Hora Agora</h1>
            <h2>Cron&ocirc;metro</h2>
            <p>
                Cron&ocirc;metro para contagem regressiva de tempo.
            </p>
        </div>
    </body>
</html>
